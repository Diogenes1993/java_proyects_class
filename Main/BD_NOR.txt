USE NORTHWIND;
SELECT YEAR(ORDERDATE) AS AÑO,EMPLOYEEID,ORDERID FROM ORDERS
ORDER BY YEAR(ORDERDATE),EMPLOYEEID;

SELECT * FROM ORDERS;
-- POR EMPLEADO
SELECT YEAR(ORDERDATE) AS AÑO,
	MAX(IF(EMPLOYEEID=1,ORDERID,NULL)) AS EMPLEADO1,
    MAX(IF(EMPLOYEEID=2,ORDERID,NULL))AS EMPLEADO2,
    MAX(IF(EMPLOYEEID=3,ORDERID,NULL))AS EMPLEADO3,
    MAX(IF(EMPLOYEEID=4,ORDERID,NULL))AS EMPLEADO4,
    MAX(IF(EMPLOYEEID=5,ORDERID,NULL))AS EMPLEADO5,
    MAX(IF(EMPLOYEEID=6,ORDERID,NULL))AS EMPLEADO6,
    MAX(IF(EMPLOYEEID=7,ORDERID,NULL))AS EMPLEADO7,
    MAX(IF(EMPLOYEEID=8,ORDERID,NULL))AS EMPLEADO8,
    MAX(IF(EMPLOYEEID=9,ORDERID,NULL))AS EMPLEADO9
FROM ORDERS 
GROUP BY YEAR(ORDERDATE);

-- INNER JOIN POR EMPLEADO
SELECT * FROM EMPLOYEES;

CREATE VIEW V_DATA_AÑO
AS
SELECT YEAR(ORDERDATE) AS AÑO,
	MAX(IF(EM.FIRSTNAME='Nancy',ORDERID,NULL)) AS NANCY,
    MAX(IF(EM.FIRSTNAME='Andrew',ORDERID,NULL))AS ANDREW,
    MAX(IF(EM.FIRSTNAME='Janet',ORDERID,NULL))AS JANET,
    MAX(IF(EM.FIRSTNAME='Margaret',ORDERID,NULL))AS MARGARET,
    MAX(IF(EM.FIRSTNAME='Steven',ORDERID,NULL))AS STEVEN,
    MAX(IF(EM.FIRSTNAME='Michael',ORDERID,NULL))AS MICHAEL,
    MAX(IF(EM.FIRSTNAME='Robert',ORDERID,NULL))AS ROBERT,
    MAX(IF(EM.FIRSTNAME='Laura',ORDERID,NULL))AS LAURA,
    MAX(IF(EM.FIRSTNAME='Anne',ORDERID,NULL))AS ANNE
FROM ORDERS AS O INNER JOIN EMPLOYEES AS EM 
ON O.EMPLOYEEID=EM.EMPLOYEEID
GROUP BY YEAR(ORDERDATE);


SELECT * FROM V_DATA_AÑO;
-- POR AÑO
SELECT EMPLOYEEID,
	MAX(IF( YEAR(ORDERDATE)='1996',ORDERID,NULL)) AS AÑO_1996,
    MAX(IF( YEAR(ORDERDATE)='1997',ORDERID,NULL))AS AÑO_1997,
    MAX(IF( YEAR(ORDERDATE)='1998',ORDERID,NULL))AS AÑO_1998
   
FROM ORDERS
GROUP BY EMPLOYEEID;

-- INNER JOIN POR AÑO+

CREATE VIEW V_DATA_EMPLOYEES
AS
SELECT EM.FIRSTNAME,
	MAX(IF( YEAR(ORDERDATE)='1996',ORDERID,NULL)) AS AÑO_1996,
    MAX(IF( YEAR(ORDERDATE)='1997',ORDERID,NULL))AS AÑO_1997,
    MAX(IF( YEAR(ORDERDATE)='1998',ORDERID,NULL))AS AÑO_1998
FROM ORDERS AS O INNER JOIN EMPLOYEES AS EM 
ON O.EMPLOYEEID=EM.EMPLOYEEID
GROUP BY EM.FIRSTNAME;


    
    
    