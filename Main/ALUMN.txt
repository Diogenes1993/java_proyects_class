CREATE DATABASE COLEGIO;
USE COLEGIO;
DROP TABLE ALUMNO;
CREATE TABLE ALUMNO
(
	NOMBRE 	VARCHAR(40),
    MATERIA	VARCHAR(40),
    NOTA 	INT
);

-- NOTA APROVATORIA
INSERT INTO ALUMNO VALUES('Alex','Matemática','20');
INSERT INTO ALUMNO VALUES('Alex','Lógica','18');
INSERT INTO ALUMNO VALUES('Alex','Inglés','17');
INSERT INTO ALUMNO VALUES('Alex','Arte','19');


INSERT INTO ALUMNO VALUES('Anier','Matemática','18');
INSERT INTO ALUMNO VALUES('Anier','Lógica','20');
INSERT INTO ALUMNO VALUES('Anier','Inglés','13');
INSERT INTO ALUMNO VALUES('Anier','Arte','18');


INSERT INTO ALUMNO VALUES('Diego','Matemática','15');
INSERT INTO ALUMNO VALUES('Diego','Lógica','16');
INSERT INTO ALUMNO VALUES('Diego','Inglés','20');
INSERT INTO ALUMNO VALUES('Diego','Arte','20');


-- DESAPROVADOS

INSERT INTO ALUMNO VALUES('Alex','Matemática','8');
INSERT INTO ALUMNO VALUES('Alex','Lógica','10');
INSERT INTO ALUMNO VALUES('Alex','Inglés','9');
INSERT INTO ALUMNO VALUES('Alex','Arte','7');


INSERT INTO ALUMNO VALUES('Anier','Matemática','7');
INSERT INTO ALUMNO VALUES('Anier','Lógica','10');
INSERT INTO ALUMNO VALUES('Anier','Inglés','10');
INSERT INTO ALUMNO VALUES('Anier','Arte','9');


INSERT INTO ALUMNO VALUES('Diego','Matemática','8');
INSERT INTO ALUMNO VALUES('Diego','Lógica','9');
INSERT INTO ALUMNO VALUES('Diego','Inglés','6');
INSERT INTO ALUMNO VALUES('Diego','Arte','7');


INSERT INTO ALUMNO VALUES('Katerin','Matemática','20');





SELECT * FROM ALUMNO;


SELECT  NOMBRE, 
  MAX(IF(MATERIA = "Mátematica",NOTA,NULL)) AS Mátematica,
  MAX(IF( MATERIA = "Lógica",NOTA,NULL)) AS Lógica,
  MAX(IF(MATERIA = "Inglés",NOTA ,NULL)) AS Inglés,
  MAX(IF(MATERIA = "Arte",NOTA ,NULL)) AS Arte 
FROM ALUMNO
GROUP BY  NOMBRE;


SELECT  NOMBRE, 
  MIN(IF(MATERIA = "Mátematica",NOTA,NULL)) AS Mátematica,
  MIN(IF( MATERIA = "Lógica",NOTA,NULL)) AS Lógica,
  MIN(IF(MATERIA = "Inglés",NOTA ,NULL)) AS Inglés,
  MIN(IF(MATERIA = "Arte",NOTA ,NULL)) AS Arte 
FROM ALUMNO
GROUP BY  NOMBRE;

-- VISTAS
CREATE VIEW V_ALUMNO_MAYOR_NOTA
AS
SELECT  NOMBRE, 
  MIN(IF(MATERIA = "Mátematica",NOTA,NULL)) AS Mátematica,
  MIN(IF( MATERIA = "Lógica",NOTA,NULL)) AS Lógica,
  MIN(IF(MATERIA = "Inglés",NOTA ,NULL)) AS Inglés,
  MIN(IF(MATERIA = "Arte",NOTA ,NULL)) AS Arte 
FROM ALUMNO
GROUP BY  NOMBRE;

SELECT * FROM V_ALUMNO_MAYOR_NOTA;

